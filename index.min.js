console.group("[pkg93]"),console.log("[pkg93] Injecting packages...");try{localStorage[".pkg93/config.json"]===void 0&&(console.log("[pkg93] You seem new. Creating config..."),localStorage[".pkg93/config.json"]="{\"repos\": [\"http://codinggamerhd.com/main-repo\"], \"installed\": [], \"pkglist\": []}");var config=JSON.parse(localStorage[".pkg93/config.json"]);config.installed.forEach(function(pkg){eval(localStorage[".pkg93/packages/"+pkg+".js"])})}catch(a){console.error("[pkg93] Couldn't load package information.")}console.log("[pkg93] Done!"),console.groupEnd();var pkg93={getConfig:function(){try{return JSON.parse(localStorage[".pkg93/config.json"])}catch(a){return!1}},pull:function(){var a=pkg93.getConfig(),b=new XMLHttpRequest;$log("<b><span style='color:#ff0'>WARN</span></b> Windows93 may lag while getting packages.\n      This is a normal thing."),a.pkglist=[],a.repos.forEach(function(c){$log("<b><span style='color:#f0f'>GET</span></b>  "+c),b.open("GET",c+"/repo.json",!1);try{b.send(null);var d=JSON.parse(b.responseText);$log("<b><span style='color:#0f0'>NAME</span></b> "+d.name),$log("<b><span style='color:#0f0'>MSG</span></b>  "+d.msg),d.packages.forEach(function(e){try{$log("<b><span style='color:#0f0'>OK</span></b>   "+e+"@"+c),a.pkglist.push(e+"@"+c)}catch(f){$log("<b><span style='color:#f00'>ERR</span></b>  "+f.message)}})}catch(e){$log("<b><span style='color:#f00'>ERR</span></b>  "+e.message),$log(b.responseText)}}),localStorage[".pkg93/config.json"]=JSON.stringify(a)},get:function(pkg){var config=pkg93.getConfig(),request=new XMLHttpRequest;$log("<b><span style='color:#f0f'>SRCH</span></b> "+pkg);var index=config.pkglist.findIndex(function(a){return a.split("@")[0]==pkg});if(0>index)return $log("<b><span style='color:#f00'>ERR</span></b>  Not found."),!1;$log("<b><span style='color:#0f0'>OK</span></b>   Found!");var pkgname=config.pkglist[index].split("@")[0],pkgsource=config.pkglist[index].split("@")[1];request.open("GET",pkgsource+"/"+pkgname+"/package.json",!1);try{request.send(null);var json=JSON.parse(request.responseText);return localStorage[".pkg93/packages/"+pkgname+".json"]=request.responseText,json.dependencies&&json.dependencies.forEach(function(a){try{if($log("<b><span style='color:#f0f'>DPND</span></b> Getting dependency \""+a+"\""),output=pkg93.get(a),!output)throw new Error("Dependency \""+a+"\" failed to install. Current package may not work!")}catch(b){$log("<b><span style='color:#f00'>ERR</span></b>  "+b.message)}}),request.open("GET",pkgsource+"/"+pkgname+"/"+json.inject,!1),request.send(null),localStorage[".pkg93/packages/"+pkgname+".js"]=request.responseText,eval(request.responseText),json.uninstall&&(request.open("GET",pkgsource+"/"+pkgname+"/"+json.uninstall,!1),request.send(null),localStorage[".pkg93/packages/"+pkgname+".rm.js"]=request.responseText),$log("<b><span style='color:#0f0'>OK</span></b>   Injected package!"),config.installed.includes(pkgname)||config.installed.push(pkgname),localStorage[".pkg93/config.json"]=JSON.stringify(config),!0}catch(a){return $log("<b><span style='color:#f00'>ERR</span></b>  "+a.message),!1}},rm:function(pkg){var config=pkg93.getConfig(),request=new XMLHttpRequest,index=config.installed.indexOf(pkg);if(0>index)return $log("<b><span style='color:#f00'>ERR</span></b>  Not found."),!1;if(!!localStorage[".pkg93/packages/"+pkg+".rm.js"])eval(localStorage[".pkg93/packages/"+pkg+".rm.js"]),delete le._apps[config.installed[index]],delete localStorage[".pkg93/packages/"+pkg+".rm.js"],delete localStorage[".pkg93/packages/"+pkg+".js"],delete localStorage[".pkg93/packages/"+pkg+".json"],config.installed.splice(index,1),$log("<b><span style='color:#0f0'>OK</span></b>   Removed!");else try{return null===le._apps[config.installed[index]]?($log("<b><span style='color:#f00'>ERR</span></b>  Already removed."),!1):(delete le._apps[config.installed[index]],delete localStorage[".pkg93/packages/"+config.installed[index]+".js"],delete localStorage[".pkg93/packages/"+config.installed[index]+".json"],config.installed.splice(index,1),$log("<b><span style='color:#0f0'>OK</span></b>   Removed!"),(localStorage[".pkg93/config.json"]=JSON.stringify(config),!0))}catch(a){return $log("<b><span style='color:#f00'>ERR</span></b>  "+a.message),!1}}};le._apps.pkg93={exec:function(){"use strict";var a=["3d","acid","acidbox","ansi","anthology","arena93","bananamp","base64","bytebeat","calc","castlegafa","catex","cd","clear","clearhist","clippy","code","contact","crazy","defrag","dmg","do a barrel roll","doctor","download","find","font","format","fullscreen","fx","gameoflife","glitch","global thermonuclear war","gravity","hampster","hello","help","hexed","history","hl3","hydra","ie6","iframe","img","info","js","key","killall","layer","lenna","lisa","ls","manifesto","marburg","messenger","mines","necronomicoin","pd","piskel","pkg93","pony","potato","progressquest","pwd","reboot","robby","rotate","shutdown","skifree","solitude","speech","starwars","superplayer","takethis","terminal","textarea","tree","trollbox","vega","virtualpc","vm","wat","whatif","whois","win","zkype"],b=this.arg.arguments,d=`<b>pkg93 ${"v1.2.0"}</b>
<b>Usage:</b> pkg93 [command]

<b><u>List of Commands</u></b>
<span style='color:#0f0'>pull</span>                      Updates package listing
<span style='color:#0f0'>get</span> <span style='color:#77f'>[package]</span>             Installs a package
<span style='color:#0f0'>rm</span> <span style='color:#77f'>[package]</span>              Uninstalls a package
<span style='color:#0f0'>add-repo</span> <span style='color:#77f'>[url]</span>            Adds a repository
<span style='color:#0f0'>rm-repo</span> <span style='color:#77f'>[id]</span>              Removes a repository
<span style='color:#0f0'>ls</span> <span style='color:#77f'>[pkgs|installed|repos]</span> Lists all packages, installed
                          packages or repositories.
<b><u>Color meanings</u></b>
<b><span style='color:#f0f'>Executing</span> <span style='color:#0f0'>OK</span> <span style='color:#f00'>Error</span> <span style='color:#ff0'>Warning</span></b>

<b><u>Examples</u></b>
pkg93 <span style='color:#0f0'>get</span> <span style='color:#77f'>gud</span>
pkg93 <span style='color:#0f0'>rm</span> <span style='color:#77f'>kebab</span>`;localStorage[".pkg93/config.json"]===void 0&&(localStorage[".pkg93/config.json"]="{\"repos\": [\"http://codinggamerhd.com/main-repo\"], \"installed\": [], \"pkglist\": []}"),localStorage[".pkg93/packages/"]===void 0&&(localStorage[".pkg93/packages/"]=""),localStorage[".pkg93/README.txt"]="WARNING!\nThis folder contains important data about pkg93. Do not edit anything in here unless you want pkg93 to not work!\n\n~1024x2";var e=pkg93.getConfig();if(0===b.length)$log(d);else if("pull"==b[0])pkg93.pull();else if("get"==b[0])2>b.length?$log("<b><span style='color:#f00'>ERR</span></b>  No package specified."):a.includes(b[1])?$log("<b><span style='color:#f00'>ERR</span></b>  You're trying to modify a pre-installed Windows93 app.\n      <b>Don't do that!</b>"):pkg93.get(b[1]);else if("rm"==b[0])2>b.length?$log("<b><span style='color:#f00'>ERR</span></b>  No package specified."):a.includes(b[1])?$log("<b><span style='color:#f00'>ERR</span></b>  You're trying to modify a pre-installed Windows93 app.\n      <b>Don't do that!</b>"):pkg93.rm(b[1]);else if("add-repo"==b[0])try{e.repos.push(b[1]),localStorage[".pkg93/config.json"]=JSON.stringify(e),$log("<b><span style='color:#0f0'>OK</span></b>   Done!\n     Run \"pkg93 pull\" to update the package listing.")}catch(f){$log("<b><span style='color:#f00'>ERR</span></b>  "+f.message)}else if("rm-repo"==b[0])try{e.repos.splice(parseInt(b[1]),1),localStorage[".pkg93/config.json"]=JSON.stringify(e),$log("<b><span style='color:#0f0'>OK</span></b>   Done!\n     Run \"pkg93 pull\" to update the package listing.")}catch(f){$log("<b><span style='color:#f00'>ERR</span></b>  "+f.message)}else"ls"==b[0]?"pkgs"==b[1]?$log(e.pkglist.join("\n")):"installed"==b[1]?$log(e.installed.join("\n")):"repos"==b[1]?(lerepos="",e.repos.forEach(function(f,g){lerepos+="["+g+"] "+f+"<br>"}),$log(lerepos)):$log("<b><span style='color:#f00'>ERR</span></b>  You must select either pkgs, installed, or repos."):"help"==b[0]?$log(d):"wtf"==b[0]?(new Audio("/c/sys/sounds/QUACK.ogg").play(),wtf=["mudkipz","pkg93","memes","linux","javascript","git","cpu","windows93","discord","kirb","apt93","delays","trash","kernel panic","bash","package manager","recusion"],$log("<b><span style='color:#0f0'>WTF?</span></b> "+wtf[Math.floor(Math.random()*wtf.length)]+" + "+wtf[Math.floor(Math.random()*wtf.length)]+" = "+wtf[Math.floor(Math.random()*wtf.length)])):$log("<b><span style='color:#f00'>ERR</span></b>  Invalid command. Type \"pkg93\" without any arguments for help.")},icon:"//cdn.rawgit.com/1024x2/pkg93/70039c02/pkg.png",terminal:!0,hascli:!0,categories:"Network;"};
